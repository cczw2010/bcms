# BCMS V1.0   build by awen  email:71752352@qq.com

## 说明

   该框架是一个简单的基于PHP的cmf框架，核心思想是AOP(面向切面编程，借鉴drupal的hook)和模块式开发(也可以参考drupal)。框架内部集成了`内容模块`，`用户模块`，`权限模块`，`模板模块`，`缓存模块`，`第三方登陆模块`,`分类模块`，`商品模块`,`评论模块`,`支付模块`等等.基本上可以直接拿来当cms系统使用。同时灵活的模块方式也便于用户二次开发。
   
   很多思想借助了ci框架，开发这套系统仅仅是为了自己使用着更加方便罢了。
	
## 开发思想

1 模块式开发

   一切功能皆模块，模块可以抽象出一个面向业务的模型出来，所有的模块通过统一的模型来开发。这样一来整个框架便于管理，集成，和扩展，用户熟悉了开发模型后，基本就了解了整个程序的开发模式。。

2 mvc 
 
传统的mvc结构，当然你完全可以不这么写

3 resetful
	
url支持原始模式和reset模式，默认reset模式（'/'）,详情可查看config.php

4 缓存策略

数据库操作与缓存处理绑定使用，api支持是否缓存的选项，当然有些系统配置是变更自动更新缓存的，例如第三方登陆列表，支付配置信息，敏感词模块，邮件配置等，详情关注后台【缓存处理】


## 安装
	
+ 在nginx或者apache中设置index.php为唯一入口,参考根目录下的nginx和apache配置文件
+ 目录权限， upfiles,cache,backup目录必须拥有可读写权限
+ php扩展，用户头像和图片处理库SImage依托于imagick,请注意安装
+ 本程序用的是utf-8字符，所以数据库的默认配置中的字符请设置成utf-8
+ 本程序中的一些第三方控件要求服务器short_open_tag=On,还好一般都开启的，另外需要openssl支持
+ 很多网站系统都忽略了一个问题，就是富文本编辑器编辑的效果和目标展示页面的效果不一致，原因就是后台编辑的时候页面的css样式和展示页面的css样式不一致。
  initTinymce是网站初始化富文本编辑器的包装js方法，支持注入编辑器css文件参数，请根据展示页面的样式修改该方法的参数，以确保编辑器中与最终显示的时候效果一致（很多网站系统都忽略了该问题）
+ backup中包含了元数据库的备份，直接导入即可。

config.php文件中设置该系统的所有配置。
nginx.conf 需要配置到nginx中
后台地址：http://xxxx:xx/manage
超级管理员：admin 密码：123456


## gulp

静态文件的开发使用了gulp工程化处理，当然你也可以不用。但是用起来还是非常非常方便的，具体配置可查看gulpfile.js 文件。支持js,css,img自动压缩合并监听，省你很多事。
	
	在根目录下执行：npm install  安装完必须包后，执行gulp

## 目录介绍
* system

	系统文件夹，请尽量不要改变该文件夹下的文件
	common.php   一些通用全局方法，包括类库autoload,dump,showMessage等方法

* system/core
	
	系统内核

* system/libs

	本目录下的库为系统内核运行所需的自带库，例如
	Db*数据库操作类库，Cache*缓存处理库(系统会根据配置信息生成默认的默认的Cache和Db处理类)

* module
	
	各个模块的通用处理类库，系统会在需要时自动加载相应的库，所以用户可以直接使用，但是文件名称必须按照命名规则来：
	className.class.php 其中 className 是类名小写。建议全部都做成静态的

* library
	
	该目录，放置了一些系统自带的通用类库（有一部分被系统内核使用，例如SFile 文件处理库，Helper辅助类），
	也可以放置用户自己封装的类库,并且系统会再需要的时候自动加载该目录下的类库，但是文件名称必须按照命名规则来：
	className.class.php 其中 className 是类名小写。建议全部都做成静态的
* cache

	缓存目录，请注意读写权限
	
* backup

	数据库备份目录，请注意读写权限

* static

	静态引用文件路径，头像处理也在这里，请注意读写权限（不遵循目前的路由规则，直接按目录引用）,这里用到了自己配置的前端工程自动化工具gulp,只需要再命令行下执行:
		$npm install
		$gulp --gulpfile gulpfile.js

* datas

	动态文件或者模块直接引用地址（不遵循目前的路由规则，直接按目录引用，方便用户增加第三方扩展）

* upfiles

	文件上传目录 ，为方便生成用户，格式为： upfiles/{userid}/年-月/（不遵循目前的路由规则，直接按目录引用）

* test
	框架测试代码（/tester/xxx）使用的临时文件夹

* apps 

	应用文件夹，该文件夹是放置实际应用版本库的地方，一个应用可能开发很多版本，一个版本对应一个文件夹，内部包含controller,model,和view。系统默认为default版本。
	
* apps/controller

	控制层，所有的页面业务逻辑在这里展现

* apps/model

	数据模型,本目录下的库是用户自己封装的相关类库（可以在这里写数据缓存）。
	在此可以使用modules中封装的各个对应的模块来获取数据，也可直接使用 $GLOBALS['db']自己操作数据库
	在controller中可以使用$this->model->load('文件名')来加载，返回实例。

* apps/view

	模板 ，在controller中可以使用$this->view->load('文件名')来加载，返回实例。
	
* config.php

	一些配置，用户可以根据需求修改该处配置,配置文件生命在了超级全局变量中，所以可以再任何地方通过 $GLOBALS['config']调用
	
* index.php

	本应用的入口文件，系统应该将该文件作为入口文件